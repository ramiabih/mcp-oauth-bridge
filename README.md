# MCP OAuth Bridge

**Bridge OAuth-based MCP servers to headless environments**

[![CI](https://github.com/ramiabih/mcp-oauth-bridge/actions/workflows/ci.yml/badge.svg)](https://github.com/ramiabih/mcp-oauth-bridge/actions/workflows/ci.yml)
[![npm version](https://img.shields.io/npm/v/mcp-oauth-bridge.svg)](https://www.npmjs.com/package/mcp-oauth-bridge)
[![Node.js](https://img.shields.io/badge/node-%3E%3D18-brightgreen.svg)](https://nodejs.org)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## Problem

Many MCP servers use OAuth 2.0 browser-based authentication, which breaks on headless environments — VPS servers, Docker containers, CI/CD pipelines. You can't complete a browser redirect on a machine without a browser.

## Solution

Authenticate once on your local machine (where a browser exists), then run the bridge anywhere. Tokens are deployed to the remote server and auto-refreshed from there.

```
Local machine  →  mcp-oauth-bridge auth <server>  →  browser OAuth
                                                          ↓
VPS            ←  ~/.mcp-bridge/tokens/            ←  token saved
```

## Quick Start

```bash
npm install -g mcp-oauth-bridge
```

**1. Initialize**
```bash
mcp-oauth-bridge init
# Creates ~/.mcp-bridge/config.json with a generated API password
```

**2. Add a server**
```bash
mcp-oauth-bridge add granola https://mcp.granola.ai/mcp \
  --auth-url https://auth.granola.ai/oauth/authorize \
  --token-url https://auth.granola.ai/oauth/token \
  --client-id <your-client-id> \
  --scopes "read write"
```

**3. Authenticate** (run this on your local machine, not the VPS)
```bash
mcp-oauth-bridge auth granola
# Opens browser. On headless machines: --manual to paste the redirect URL instead.
```

**4. Deploy tokens to VPS**
```bash
scp -r ~/.mcp-bridge/tokens/ user@your-vps:~/.mcp-bridge/
```

**5. Start the bridge**
```bash
mcp-oauth-bridge start --port 3000 --host 0.0.0.0
```

**6. Use it**
```bash
curl -H "Authorization: Bearer <password>" http://your-vps:3000/mcp/granola/tools
curl -H "Authorization: Bearer <password>" http://your-vps:3000/mcp/granola/call \
  -d '{"tool": "search_meetings", "arguments": {"query": "roadmap"}}'
```

## CLI Reference

| Command | Description |
|---------|-------------|
| `init` | Create `~/.mcp-bridge/config.json` |
| `add <name> <url> [options]` | Register an MCP server |
| `remove <name>` | Remove a server and delete its token |
| `list` | Show servers and auth status |
| `auth <name> [--manual] [--callback-port N]` | Run OAuth flow |
| `start [--port N] [--host H]` | Start the HTTP bridge |

## API

All routes (except `/health`) require `Authorization: Bearer <password>`.

| Method | Path | Description |
|--------|------|-------------|
| `GET` | `/health` | Status check |
| `GET` | `/servers` | List servers and token status |
| `GET` | `/mcp/:server/tools` | List tools from an MCP server |
| `POST` | `/mcp/:server/call` | Call a tool: `{"tool": "...", "arguments": {...}}` |

## Config

`~/.mcp-bridge/config.json` is generated by `init`. The `servers` block is populated by `add`:

```json
{
  "port": 3000,
  "host": "localhost",
  "auth": { "type": "password", "password": "generated-password" },
  "servers": {
    "granola": {
      "name": "granola",
      "url": "https://mcp.granola.ai/mcp",
      "oauth": {
        "authorizationUrl": "https://auth.granola.ai/oauth/authorize",
        "tokenUrl": "https://auth.granola.ai/oauth/token",
        "clientId": "your-client-id",
        "scopes": ["read", "write"]
      }
    }
  }
}
```

## Requirements

- Node.js ≥ 18
- A local machine with a browser (for the initial `auth` step)
- The target MCP server must support OAuth 2.0 Authorization Code flow (PKCE supported)

## Contributing

See [CONTRIBUTING.md](CONTRIBUTING.md).

## License

MIT © 2026 Rami
